!function(w){"use strict";function n(t,s){return this.elements=w(t),this.last=[],this.current=[],this.enableEvents=!0,this.backup=[],this.options=w.extend({},w.fn.tcTabs.defaults,s),0<this.elements.length&&(this.init(),this)}var y=w.epoAPI.util.getStorage("localStorage"),h=window.confirm;n.prototype={constructor:n,set:function(t){this.options=w.extend({},this.options,t),this.init(!0)},addHeaderEvents:function(i,o,e,t,n,l,r,d,c){var s="",p=this;t.off("closetab.tmtabs").on("closetab.tmtabs",function(){var t=w(this),s=i.find(t.data("tab"));t.removeClass("closed open").addClass("closed"),t.find(".tm-arrow").removeClass(p.options.classdown+" "+p.options.classup).addClass(p.options.classdown),p.options.useclasstohide?s.addClass("tm-hide").removeClass("tm-show"):s.hide(),s.removeClass("tm-animated "+p.options.animationclass),w(window).trigger("tc-closetab.tmtabs",{header:t,tab:s})}),t.off("opentab.tmtabs").on("opentab.tmtabs",function(){var t=w(this),s=i.find(t.data("tab"));t.removeClass("closed open").addClass("open"),t.find(".tm-arrow").removeClass(p.options.classdown+" "+p.options.classup).addClass(p.options.classup),p.options.useclasstohide?s.removeClass("tm-hide").addClass("tm-show"):s.show(),s.removeClass("tm-animated "+p.options.animationclass).addClass("tm-animated "+p.options.animationclass),p.current[o]=t.data("tab"),w(window).trigger("tc-opentab.tmtabs",{header:t,tab:p.current[o],table:s}),p.scrollIntoView(i,t,c)}),!0!==p.options.showonhover&&"function"!=typeof p.options.showonhover||(s=" mouseover"),t.off("keydown.tmtabs").on("keydown.tmtabs",function(t){var s,o=w(this);13===t.keyCode&&o.trigger("click.tmtabs"),40===t.keyCode&&(s=o.closest(".tm-box").next().find("."+p.options.header)),(s=38===t.keyCode?o.closest(".tm-box").prev().find("."+p.options.header):s)&&s.length&&(o.trigger("blur"),s.trigger(" focus").trigger("click"),t.preventDefault())}),t.off("click.tmtabs").on("click.tmtabs"+s,function(t){var s=w(this);t.preventDefault(),"mouseover"===t.type&&"function"==typeof p.options.showonhover&&!p.options.showonhover.call()||(p.current[o]===s.data("tab")?w(window).trigger("tc-isopentab.tmtabs",{header:s,tab:p.current[o],table:i.find(p.current[o])}):(p.last[o]&&w(p.last[o]).trigger("closetab.tmtabs"),s.trigger("opentab.tmtabs"),p.last[o]=s,y&&y.setItem("tmadmintab-"+e,s.attr(p.options.dataopenattribute)),w(window).trigger("tc-tmtabs-clicked",{tc:e,options:p.options,header:s,tab:p.current[o],table:i.find(p.current[o])})))}),this.options.deletebutton?(t.append(this.options.deletebuttonhtml),t.find("."+this.options.deleteheader).off("click.tmtabs").on("click.tmtabs",function(t){var s=w(this),o=s.closest(".tm-box"),e=o.find("."+p.options.header),a=i.find("."+e.attr(p.options.dataattribute));t.stopPropagation(),i.find("."+p.options.headers+" ."+p.options.header).length<2||p.options.deleteconfirm&&!h(window.TMEPOGLOBALADMINJS.i18n_builder_delete)||("function"==typeof p.options.beforedeletetab&&p.options.beforedeletetab.call(i,s,a),a.remove(),e.is(".open")&&(o.next().find("."+p.options.header).is(".closed")?o.next().find("."+p.options.header).trigger("click.tmtabs"):o.prev().find("."+p.options.header).is(".closed")&&o.prev().find("."+p.options.header).trigger("click.tmtabs")),o.remove(),p.checkSize(n,l,r,d,c,!0),"function"==typeof p.options.afterdeletetab&&p.options.afterdeletetab.call(i))})):t.find("."+this.options.deleteheader).remove(),this.options.editbutton?(t.append(p.options.editbuttonhtml),t.find("."+p.options.editheader).off("click.tmtabs").on("click.tmtabs",function(t){var s;p.enableEvents&&"function"==typeof p.options.oneditbutton&&(t.stopPropagation(),t=w(this),s=i.find("."+t.closest(".tm-box").find("."+p.options.header).attr(p.options.dataattribute)),p.options.oneditbutton.call(i,t,s))})):t.find("."+this.options.editheader).remove()},initHeader:function(t,s,o,e,a,i,n,l){var r=s.attr("class"),d="."+(t=w(t)).attr(this.options.dataattribute);t.data("tab",d),this.options.useclasstohide?s.find(d).addClass("tm-hide").removeClass("tm-show"):s.find(d).hide(),s.find(d).data("state","closed"),t.is(".open")?(t.removeClass("closed open").addClass("open").data("state","open"),t.find(".tm-arrow").removeClass(this.options.classdown+" "+this.options.classup).addClass(this.options.classup),this.options.useclasstohide?s.find(d).removeClass("tm-hide").addClass("tm-show"):s.find(d).show(),s.find(d).data("state","open"),this.current[o]=d,this.last[o]=t):t.removeClass("closed open").addClass("closed").data("state","closed"),this.addHeaderEvents(s,o,r,t,e,a,i,n,l)},checkSize:function(t,s,o,e,a,i){var n,l=[];s.parents().addBack().not(":visible").each(function(){var t=w(this),s=this.style.display,o=t.css("display"),e=this.style.visibility,a=!1,o={styleDisplay:s,cssDisplay:o,styleVisibility:e,cssVisibility:t.css("visibility"),display:null,visibility:null,element:t};"none"===s&&(this.style.display="",o.display=!0,"none"===t.css("display")&&(this.style.display="block"),a=!0),"hidden"===e&&(this.style.visibility="",o.visibility=!0,"hidden"===t.css("visibility")&&(this.style.visibility="visible"),a=!0),a&&l.push(o)}),n=Math.round(s.outerWidth()),s.is(".has-scroll-arrows")&&(s.removeClass(".has-scroll-arrows"),n=Math.round(t.outerWidth())),i&&((t=s.find("."+this.options.header+".open")).length&&t.removeClass("open"),a.scrollWidth=s[0].scrollWidth,t.length)&&t.addClass("open"),a.scrollWidth>n?(e.addClass("scroll-arrow-show"),o.addClass("scroll-arrow-show"),s.addClass("has-scroll-arrows"),a.scrollWidth-n===s.scrollLeft()?e.addClass("scroll-arrow-disabled scroll-arrow-right-disabled"):e.removeClass("scroll-arrow-disabled scroll-arrow-right-disabled"),0===s.scrollLeft()?o.addClass("scroll-arrow-disabled scroll-arrow-left-disabled"):o.removeClass("scroll-arrow-disabled scroll-arrow-left-disabled")):(e.removeClass("scroll-arrow-show"),o.removeClass("scroll-arrow-show"),s[0].scrollLeft=0,s.removeClass("has-scroll-arrows")),l.forEach(function(t){t.display&&(t.element[0].style.display=t.styleDisplay),t.visibility&&(t.element[0].style.visibility=t.styleVisibility)})},scrollIntoView:function(t,s,o){var e=o.scrollPos,t=t.find("."+this.options.headers),a=t.width();t.is(".has-scroll-arrows")&&s&&void 0!==s&&s.position()&&void 0!==s.position()&&(s.position().left<0?(o.scrollPos=Math.max(e+s.position().left+1,0),t.animate({scrollLeft:o.scrollPos+1+"px"},this.options.scrollDuration)):s.position().left+s.outerWidth()>a&&(o.scrollPos=Math.min(e+(s.position().left+s.outerWidth()-a),t[0].scrollWidth-t.outerWidth()),t.animate({scrollLeft:o.scrollPos-1+"px"},this.options.scrollDuration)))},initElement:function(l,r,d,t){var c,p,h,m,s,n,o,f=this,b=l.attr("class"),e=l.find("."+this.options.headers+" ."+this.options.header),u=0,v="",a={};0!==e.length&&((c=l.find("."+this.options.headers)).wrap('<div class="'+this.options.headersWrap+'"></div>'),p=l.find("."+this.options.headersWrap),this.options.scroll&&(p.html('<div class="tc-scroll-left-arrow"></div>'+p.html()+'<div class="tc-scroll-right-arrow"></div>'),e=l.find("."+this.options.headers+" ."+this.options.header),c=l.find("."+this.options.headers),h=l.find(".tc-scroll-left-arrow"),m=l.find(".tc-scroll-right-arrow"),"function"==typeof w.fn.mousewheel&&c.mousewheel(function(t,s){"none"!==m.css("display")&&(this.scrollLeft-=30*s,d.scrollPos=this.scrollLeft,t.preventDefault())}),c.animate({scrollLeft:d.scrollPos+"px"},0),this.checkSize(p,c,h,m,d,!0),w(window).off("resize.tmtabs"+t).on("resize.tmtabs"+t,function(){f.checkSize(p,c,h,m,d,!0)}),l.off("refresh.tmtabs"+t).on("refresh.tmtabs"+t,function(){f.checkSize(p,c,h,m,d,!0)}),w(function(){f.checkSize(p,c,h,m,d,!0)}),m.off("mousedown.tmtabs mouseup.tmtabs mouseleave.tmtabs mouseover.tmtabs mouseout.tmtabs").on("mousedown.tmtabs",function(t){function s(){var t=c.scrollLeft();d.scrollPos=Math.min(t+f.options.scrollDistance,d.scrollWidth-c.outerWidth()),c.animate({scrollLeft:d.scrollPos+"px"},f.options.scrollDuration,function(){f.checkSize(p,c,h,m,d)})}t.stopPropagation(),s(),o=setInterval(function(){s()},f.options.scrollDuration)}).on("mouseup.tmtabs mouseleave.tmtabs",function(){clearInterval(o)}).on("mouseover.tmtabs",function(){w(this).addClass("scroll-arrow-over scroll-arrow-right-over")}).on("mouseout.tmtabs",function(){w(this).removeClass("scroll-arrow-over scroll-arrow-right-over")}),h.off("mousedown.tmtabs mouseup.tmtabs mouseleave.tmtabs mouseover.tmtabs mouseout.tmtabs").on("mousedown.tmtabs",function(t){function s(){var t=c.scrollLeft();d.scrollPos=Math.max(t-f.options.scrollDistance,0),c.animate({scrollLeft:d.scrollPos+"px"},f.options.scrollDuration,function(){f.checkSize(p,c,h,m,d)})}t.stopPropagation(),s(),o=setInterval(function(){s()},f.options.scrollDuration)}).on("mouseup.tmtabs mouseleave.tmtabs",function(){clearInterval(o)}).on("mouseover.tmtabs",function(){w(this).addClass("scroll-arrow-over scroll-arrow-left-over")}).on("mouseout.tmtabs",function(){w(this).removeClass("scroll-arrow-over scroll-arrow-left-over")})),window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,s,o){a[s]=o}),this.last[r]=!1,this.current[r]="",l.data("tm-has-tmtabs",1),e.each(function(t,s){f.initHeader(s,l,r,p,c,h,m,d)}),this.options.sortabletabs&&l.find("."+this.options.headers+":not(.section_elements ."+this.options.headers+",.tm-settings-wrap ."+this.options.headers+",.builder-element-wrap ."+this.options.headers+")").sortable({cursor:"move",items:".tm-box:not(.tm-add-box)",start:function(t,s){var o=l.find("."+s.item.closest(".tm-box").find("."+f.options.header).attr(f.options.dataattribute));u=s.item.index(),v=s.item.find("."+f.options.header).attr(f.options.dataopenattribute),n=w.tmEPOAdmin.find_index(!0,o.find(".bitem").first()),"function"==typeof f.options.beforemovetab&&f.options.beforemovetab.call(this,u,o,n),f.enableEvents=!1},stop:function(t,s){var o,e,a=l.find("."+s.item.closest(".tm-box").find("."+f.options.header).attr(f.options.dataattribute)),s=l.find("."+f.options.slide+"."+v),i=l.find("."+f.options.headers+" ."+f.options.header+"["+f.options.dataopenattribute+"='"+v+"']").parent().index();i!==u&&(o=l.find("."+f.options.slide).eq(i),(e=s.tcClone()).find(".bitem").remove(),u<i?o.after(e):i<u&&o.before(e),s.find(".bitem").toArray().forEach(function(t){t=w(t),"function"==typeof f.options.beforemovebitem&&f.options.beforemovebitem.call(this,i,u,a,n,t),e.append(t),"function"==typeof f.options.aftermovebitem&&f.options.aftermovebitem.call(this,i,u,a,n,t)}),s.remove(),"function"==typeof f.options.aftermovetab)&&f.options.aftermovetab.call(this,i,u,a,n),f.enableEvents=!0},cancel:".tm-add-box",forcePlaceholderSize:!0,revert:200,placeholder:"tm-box pl",tolerance:"pointer"}),this.options.addbutton?(p.append(this.options.addbuttonhtml),l.addClass("has-add-button").find("."+this.options.addheader).off("click.tmtabs").on("click.tmtabs",function(t){var s=l.find("."+f.options.headers+" ."+f.options.header),o=s.last(),e=o.attr(f.options.dataattribute),a=l.find("."+e),i=o.tcClone().off("closetab.tmtabs opentab.tmtabs click.tmtabs"),n=a.tcClone().empty(),s=f.options.slide+s.length;t.preventDefault(),i.html('<span class="tab-text">'+(l.find("."+f.options.headers+" ."+f.options.header).length+1)+"</span>").removeClass("closed open").addClass("closed").data("tab","."+s).data("state","closed").attr(f.options.dataattribute,s),n.removeClass(e).addClass(s),f.options.useclasstohide?n.addClass("tm-hide").removeClass(".tm-show"):n.hide(),n.removeClass("tm-animated "+f.options.animationclass),o.closest(".tm-box").after(i),i.wrap('<div class="tm-box"></div>'),f.addHeaderEvents(l,r,b,i,p,c,h,m,d),a.after(n),f.options.scroll&&c.animate({scrollLeft:i.width()+"px"},f.options.scrollDuration,function(){f.checkSize(p,c,h,m,d,!0)}),"function"==typeof f.options.afteraddtab&&f.options.afteraddtab.call(this,i,n)})):p.find("."+this.options.addheader).remove(),"auto"===this.options.selectedtab?(y&&(s=y.getItem("tmadmintab-"+b)),void 0!==a.selected_tab&&(s=a.selected_tab),null==(s=void 0!==a.menu?a.menu:s)&&(s=l.find("."+this.options.header).eq(0).attr(this.options.dataopenattribute)),(l.find("."+this.options.header+"["+this.options.dataopenattribute+'="'+s+'"]').is(":visible")?l.find("."+this.options.header+"["+this.options.dataopenattribute+'="'+s+'"]'):l.find("."+this.options.header).eq(0)).trigger("click.tmtabs")):!1!==this.options.selectedtab&&(s=parseInt(this.options.selectedtab,10),l.find("."+this.options.header+":eq("+s+")").trigger("click.tmtabs")))},init:function(a){var i=this;this.elements.each(function(t){var s=w(this),o={},e=s.html();!a&&i.backup[t]?s.html(i.backup[t]):i.backup[t]=e,o.scrollPos=0,o.scrollWidth=0,e=s.css("display"),s.show(),i.initElement(s,t,o,w.epoAPI.math.uniqueid("")),s.css("display",e)})}},w.fn.tcTabs=function(t){var s,o,e=w(this),a=e.data("tctabs"),i=w.makeArray(arguments);return i.splice(0,1),o="object"==typeof t?t:{},a||(a=new n(this,o),e.data("tctabs",a)),void 0===(s="string"==typeof t?a[t].apply(a,i):s)?e:s},w.fn.tcTabs.defaults={headers:"tm-tab-headers",headersWrap:"tc-tab-headers-wrap",header:"tab-header",slide:"tc-tab-slide",classdown:"tcfa-angle-down",classup:"tcfa-angle-up",animationclass:"appear",dataattribute:"data-id",dataopenattribute:"data-id",selectedtab:"auto",showonhover:!1,useclasstohide:!0,sortabletabs:!0,addbutton:!1,addheader:"tm-add-tab",addbuttonhtml:'<div class="tm-add-tab"><span class="tmicon tcfa tcfa-plus"></span></div>',afteraddtab:null,beforemovetab:null,aftermovetab:null,beforemovebitem:null,aftermovebitem:null,deletebutton:!1,deletebuttonhtml:'<div class="tm-del-tab"><span class="tcfa tcfa-times"></span></div>',deleteheader:"tm-del-tab",deleteconfirm:!1,beforedeletetab:null,afterdeletetab:null,editbutton:!1,editbuttonhtml:'<span class="tm-edit-tab"><span class="tcfa tcfa-edit"></span></span>',editheader:"tm-edit-tab",oneditbutton:null,scroll:!0,scrollDistance:300,scrollDuration:300},w.fn.tcTabs.Constructor=n,w.fn.tmtabs=w.fn.tcTabs}(window.jQuery);