!function(t,a,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"undefined"==typeof Meteor?window.module.exports=t(window.require("jquery")):t(a||e)}(function(r){"use strict";function i(u,M,y){var s,o,w=this,b={invalid:[],getCaret:function(){var t,a,e,n,s=0;try{return a=u.get(0),e=document.selection,n=a.selectionStart,e&&-1===navigator.appVersion.indexOf("MSIE 10")?((t=e.createRange()).moveStart("character",-b.val().length),s=t.text.length):!n&&"0"!==n||(s=n),s}catch(t){window.console.log(t)}},setCaret:function(t){var a,e;try{u.is(":focus")&&((e=u.get(0)).setSelectionRange?e.setSelectionRange(t,t):((a=e.createTextRange()).collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()))}catch(t){window.console.log(t)}},events:function(){u.on("keydown.mask",function(t){u.data("mask-keycode",t.keyCode||t.which),u.data("mask-previus-value",u.val()),u.data("mask-previus-caret-pos",b.getCaret()),b.maskDigitPosMapOld=b.maskDigitPosMap}).on(r.jMaskGlobals.useInput?"input.mask":"keyup.mask",b.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){u.keydown().keyup()},100)}).on("change.mask",function(){u.data("changed",!0)}).on("blur.mask",function(){o===b.val()||u.data("changed")||u.trigger("change"),u.data("changed",!1)}).on("blur.mask",function(){o=b.val()}).on("focus.mask",function(t){!0===y.selectOnFocus&&r(t.target).select()}).on("focusout.mask",function(){y.clearIfNotMatch&&!s.test(b.val())&&b.val("")})},getRegexMask:function(){for(var t,a,e,n,s,o=[],r=0;r<M.length;r+=1)(e=w.translation[M.charAt(r)])?(t=e.pattern.toString().replace(/.{1}$|^.{1}/g,""),a=e.optional,(e=e.recursive)?(o.push(M.charAt(r)),n={digit:M.charAt(r),pattern:t}):o.push(a||e?t+"?":t)):o.push(M.charAt(r).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return s=o.join(""),n&&(s=s.replace(new RegExp("("+n.digit+"(.*"+n.digit+")?)"),"($1)?").replace(new RegExp(n.digit,"g"),n.pattern)),new RegExp(s)},destroyEvents:function(){u.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(t){var a=u.is("input")?"val":"text",t=0<arguments.length?(u[a]()!==t&&u[a](t),u):u[a]();return t},calculateCaretPosition:function(t){var a,e,n=b.getMasked(),s=b.getCaret(),o=0,r=0,i=0,l=0,c=0;if(t!==n){for(a=u.data("mask-previus-caret-pos")||0,e=n.length,n=t.length,c=s;c<e&&b.maskDigitPosMap[c];c+=1)r+=1;for(c=s-1;0<=c&&b.maskDigitPosMap[c];--c)o+=1;for(c=s-1;0<=c;--c)b.maskDigitPosMap[c]&&(i+=1);for(c=a-1;0<=c;--c)b.maskDigitPosMapOld[c]&&(l+=1);n<s?s=10*e:s<=a&&a!==n?b.maskDigitPosMapOld[s]||(t=s,b.maskDigitPosMap[s=s-(l-i)-o]&&(s=t)):a<s&&(s=s+(i-l)+r)}return s},behaviour:function(t){var a,e,n=u.data("mask-keycode");if(t=t||window.event,b.invalid=[],-1===r.inArray(n,w.byPassKeys))return n=b.getMasked(),e=b.getCaret(),a=u.data("mask-previus-value")||"",setTimeout(function(){b.setCaret(b.calculateCaretPosition(a))},r.jMaskGlobals.keyStrokeCompensation),b.val(n),b.setCaret(e),b.callbacks(t)},getMasked:function(t,a){for(var e,n,s,o,r,i=[],l=void 0===a?b.val():a+"",c=0,u=M.length,d=0,k=l.length,p=1,h="push",f=-1,g=0,v=[],m=y.reverse?(h="unshift",p=-1,e=0,c=u-1,d=k-1,function(){return-1<c&&-1<d}):(e=u-1,function(){return c<u&&d<k});m();)s=M.charAt(c),o=l.charAt(d),(r=w.translation[s])?(o.match(r.pattern)?(i[h](o),r.recursive&&(-1===f?f=c:c===e&&c!==f&&(c=f-p),e===f)&&(c-=p),c+=p):o===n?(g-=1,n=void 0):r.optional?(c+=p,d-=p):r.fallback?(i[h](r.fallback),c+=p,d-=p):b.invalid.push({p:d,v:o,e:r.pattern}),d+=p):(t||i[h](s),o===s?(v.push(d),d+=p):(n=s,v.push(d+g),g+=1),c+=p);return a=M.charAt(e),u!==k+1||w.translation[a]||i.push(a),a=i.join(""),b.mapMaskdigitPositions(a,v,k),a},mapMaskdigitPositions:function(t,a,e){var n,s=y.reverse?t.length-e:0;for(b.maskDigitPosMap={},n=0;n<a.length;n+=1)b.maskDigitPosMap[a[n]+s]=1},callbacks:function(t){function a(t,a,e){"function"==typeof y[t]&&a&&y[t].apply(this,e)}var e=b.val(),n=e!==o,s=[e,t,u,y];a("onChange",!0==n,s),a("onKeyPress",!0==n,s),a("onComplete",e.length===M.length,s),a("onInvalid",0<b.invalid.length,[e,t,u,b.invalid,y])}};u=r(u),o=b.val(),M="function"==typeof M?M(b.val(),void 0,u,y):M,w.mask=M,w.options=y,w.remove=function(){var t=b.getCaret();return w.options.placeholder&&u.removeAttr("placeholder"),u.data("mask-maxlength")&&u.removeAttr("maxlength"),b.destroyEvents(),b.val(w.getCleanVal()),b.setCaret(t),u},w.getCleanVal=function(){return b.getMasked(!0)},w.getMaskedVal=function(t){return b.getMasked(!1,t)},w.init=function(t){var a,e,n;if(t=t||!1,y=y||{},w.clearIfNotMatch=r.jMaskGlobals.clearIfNotMatch,w.byPassKeys=r.jMaskGlobals.byPassKeys,w.translation=r.extend({},r.jMaskGlobals.translation,y.translation),w=r.extend(!0,{},w,y),s=b.getRegexMask(),t)b.events(),b.val(b.getMasked());else{for(y.placeholder&&u.attr("placeholder",y.placeholder),u.data("mask")&&u.attr("autocomplete","off"),n=!(a=0);a<M.length;a+=1)if((e=w.translation[M.charAt(a)])&&e.recursive){n=!1;break}n&&u.attr("maxlength",M.length).data("mask-maxlength",!0),b.destroyEvents(),b.events(),t=b.getCaret(),b.val(b.getMasked()),b.setCaret(t)}},w.init(!u.is("input"))}function l(t,a,e){var n=r(t).data("mask"),s=o.stringify,t=r(t).val()||r(t).text();e=e||{};try{return"function"==typeof a&&(a=a(t)),"object"!=typeof n||s(n.options)!==s(e)||n.mask!==a}catch(t){window.console.log(t)}}function a(){var t=r(this),a={},e="data-mask-",n=t.attr("data-mask");if(t.attr(e+"reverse")&&(a.reverse=!0),t.attr(e+"clearifnotmatch")&&(a.clearIfNotMatch=!0),"true"===t.attr(e+"selectonfocus")&&(a.selectOnFocus=!0),t.attr(e+"placeholder")&&(a.placeholder=t.attr(e+"placeholder")),l(t,n,a))return t.data("mask",new i(this,n,a))}var t,e,n,o=window.JSON;r.maskWatchers={},r.fn.mask=function(t,a){var e=this.selector,n=r.jMaskGlobals,s=n.watchInterval,n=(a=a||{}).watchInputs||n.watchInputs,o=function(){if(l(this,t,a))return r(this).data("mask",new i(this,t,a))};return r(this).each(o),e&&""!==e&&n&&(clearInterval(r.maskWatchers[e]),r.maskWatchers[e]=setInterval(function(){r(document).find(e).each(o)},s)),this},r.fn.masked=function(t){return this.data("mask").getMaskedVal(t)},r.fn.unmask=function(){return clearInterval(r.maskWatchers[this.selector]),delete r.maskWatchers[this.selector],this.each(function(){var t=r(this).data("mask");t&&t.remove().removeData("mask")})},r.fn.cleanVal=function(){return this.data("mask").getCleanVal()},r.applyDataMask=function(t){((t=t||r.jMaskGlobals.maskElements)instanceof r?t:r(t)).filter(r.jMaskGlobals.dataMaskAttr).each(a)},t={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&(t="input",n=document.createElement("div"),(e=(t="on"+t)in n)||(n.setAttribute(t,"return;"),e="function"==typeof n[t]),n=null,e),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}},r.jMaskGlobals=r.jMaskGlobals||{},(t=r.jMaskGlobals=r.extend(!0,{},t,r.jMaskGlobals)).dataMask&&r.applyDataMask(),setInterval(function(){r.jMaskGlobals.watchDataMask&&r.applyDataMask()},t.watchInterval)},window.jQuery,window.Zepto);